CRS("+proj=utm +zone=34 +datum=WGS84 +units=m +no_defs")
)
XY2 <- coordinates(emitory_UTM)
head(XY2)
emitory_ppp <- ppp(
x = XY2[,1],
y = XY2[,2],
window=as.owin(krakowUTM)
)
plot(data15_ppp)
plot(emitory_ppp, add=TRUE, pch=20, col='red')
library(dplyr)
emitory_sf  <- st_as_sf(emitory_UTM)
czujniki_sf <- st_as_sf(data_in)
buf_distance=2500
inrange <- st_is_within_distance(
czujniki_sf,
emitory_sf,
dist = buf_distance
)
em_count = lengths(inrange)
emitory_by_czujnik <- lapply(seq_along(inrange), function(i) {
emitory_sf[inrange[[i]], ]
})
corr_df <- data.frame(
matrix(ncol = 4, nrow = 0)  # 3 columns, 0 rows
)
colnames(corr_df) <- c("id","PM10","PM25","emitery")
for (i in 1:64) {
PM10 <- list_inst2[[i]]$current$values$value[list_inst2[[i]]$current$values$name == "PM10"]
PM25 <- list_inst2[[i]]$current$values$value[list_inst2[[i]]$current$values$name == "PM25"]
if (is.null(PM10) || length(PM10) == 0) PM10=-1
if (is.null(PM25) || length(PM25) == 0) PM25=-1
corr_df <- rbind(corr_df, data.frame(id = i, PM10=PM10, PM25=PM25, emitery=em_count[i]))
}
#ploty do wglądu
# for (id in 1:64){
#   plot(data15_ppp)
#   plot(data15_ppp[id])
#   plot(emitory_by_czujnik[[id]], pch=20,add=TRUE, col='blue')
# }
#jeżeli się nie zaznacza nic na plocie to znaczy że czujnik nie działa
corr_PM10 <- corr_df[,c("id","PM10","emitery")]
filt_PM10 <- subset(corr_PM10, PM10 != -1)
cor(x=filt_PM10$emitery,y=filt_PM10$PM10)
cor.test(filt_PM10$emitery, filt_PM10$PM10, method = "pearson")
plot(x=filt_PM10$emitery,y=filt_PM10$PM10)
corr_PM25 <- corr_df[,c("id","PM25","emitery")]
filt_PM25 <- subset(corr_PM25, PM25 != -1)
cor(x=filt_PM25$emitery,y=filt_PM25$PM25)
cor.test(filt_PM25$emitery, filt_PM25$PM25, method = "pearson")
plot(x=filt_PM25$emitery,y=filt_PM25$PM25)
library(dplyr)
emitory_sf  <- st_as_sf(emitory_UTM)
czujniki_sf <- st_as_sf(data_in)
dist_mat <- st_distance(czujniki_sf, emitory_sf)
bandwidth <- 5000
weights <- exp(-(dist_mat^2) / (2 * bandwidth^2))
emitory = ANTROPOPRESJA_emitory_pyłów_i_gazów
zaklady = ANTROPOPRESJA_zakłady_przemysłowe
zaklady <- zaklady %>%
filter(Typ %in% c("chemiczny", "metalurgiczny", "elektromechaniczny"))
emitory_df <- data.frame(
x = emitory$`X [PL-1992]`,
y = emitory$`Y [PL-1992]`,
id = emitory$OBJECTID
)
zaklady_df <- data.frame(
x = zaklady$`X [PL-1992]`,
y = zaklady$`Y [PL-1992]`,
id = zaklady$OBJECTID
)
nrow(emitory_df)
emitory_df <-  rbind(emitory_df, zaklady_df)
nrow(emitory_df)
coordinates(emitory_df) <- ~x+y
proj4string(emitory_df) <- CRS("+init=epsg:2180")
emitory_UTM <- spTransform(
emitory_df,
CRS("+proj=utm +zone=34 +datum=WGS84 +units=m +no_defs")
)
XY2 <- coordinates(emitory_UTM)
head(XY2)
emitory_ppp <- ppp(
x = XY2[,1],
y = XY2[,2],
window=as.owin(krakowUTM)
)
plot(data15_ppp)
plot(emitory_ppp, add=TRUE, pch=20, col='red')
library(dplyr)
emitory_sf  <- st_as_sf(emitory_UTM)
czujniki_sf <- st_as_sf(data_in)
buf_distance=2500
inrange <- st_is_within_distance(
czujniki_sf,
emitory_sf,
dist = buf_distance
)
em_count = lengths(inrange)
emitory_by_czujnik <- lapply(seq_along(inrange), function(i) {
emitory_sf[inrange[[i]], ]
})
corr_df <- data.frame(
matrix(ncol = 4, nrow = 0)  # 3 columns, 0 rows
)
colnames(corr_df) <- c("id","PM10","PM25","emitery")
for (i in 1:64) {
PM10 <- list_inst2[[i]]$current$values$value[list_inst2[[i]]$current$values$name == "PM10"]
PM25 <- list_inst2[[i]]$current$values$value[list_inst2[[i]]$current$values$name == "PM25"]
if (is.null(PM10) || length(PM10) == 0) PM10=-1
if (is.null(PM25) || length(PM25) == 0) PM25=-1
corr_df <- rbind(corr_df, data.frame(id = i, PM10=PM10, PM25=PM25, emitery=em_count[i]))
}
#ploty do wglądu
# for (id in 1:64){
#   plot(data15_ppp)
#   plot(data15_ppp[id])
#   plot(emitory_by_czujnik[[id]], pch=20,add=TRUE, col='blue')
# }
#jeżeli się nie zaznacza nic na plocie to znaczy że czujnik nie działa
library(dplyr)
emitory_sf  <- st_as_sf(emitory_UTM)
czujniki_sf <- st_as_sf(data_in)
buf_distance=2500
inrange <- st_is_within_distance(
czujniki_sf,
emitory_sf,
dist = buf_distance
)
em_count = lengths(inrange)
emitory_by_czujnik <- lapply(seq_along(inrange), function(i) {
emitory_sf[inrange[[i]], ]
})
corr_df <- data.frame(
matrix(ncol = 4, nrow = 0)  # 3 columns, 0 rows
)
colnames(corr_df) <- c("id","PM10","PM25","emitery")
for (i in 1:64) {
PM10 <- list_inst2[[i]]$current$values$value[list_inst2[[i]]$current$values$name == "PM10"]
PM25 <- list_inst2[[i]]$current$values$value[list_inst2[[i]]$current$values$name == "PM25"]
if (is.null(PM10) || length(PM10) == 0) PM10=-1
if (is.null(PM25) || length(PM25) == 0) PM25=-1
corr_df <- rbind(corr_df, data.frame(id = i, PM10=PM10, PM25=PM25, emitery=em_count[i]))
}
#ploty do wglądu
# for (id in 1:64){
#   plot(data15_ppp)
#   plot(data15_ppp[id])
#   plot(emitory_by_czujnik[[id]], pch=20,add=TRUE, col='blue')
# }
#jeżeli się nie zaznacza nic na plocie to znaczy że czujnik nie działa
corr_PM10 <- corr_df[,c("id","PM10","emitery")]
filt_PM10 <- subset(corr_PM10, PM10 != -1)
cor(x=filt_PM10$emitery,y=filt_PM10$PM10)
cor.test(filt_PM10$emitery, filt_PM10$PM10, method = "pearson")
plot(x=filt_PM10$emitery,y=filt_PM10$PM10)
corr_PM25 <- corr_df[,c("id","PM25","emitery")]
filt_PM25 <- subset(corr_PM25, PM25 != -1)
cor(x=filt_PM25$emitery,y=filt_PM25$PM25)
cor.test(filt_PM25$emitery, filt_PM25$PM25, method = "pearson")
plot(x=filt_PM25$emitery,y=filt_PM25$PM25)
dist_mat <- st_distance(data_in, emitory_df)
dist_mat <- st_distance(czujniki_sf, emitory_sf)
bandwidth <- 1000  # meters (your effective buffer size)
weights <- exp(-(dist_mat^2) / (2 * bandwidth^2))
class(dist_mat)
dist_mat <- st_distance(czujniki_sf, emitory_sf)
dist_mat <- as.numeric(dist_mat)
bandwidth <- 1000  # meters (your effective buffer size)
weights <- exp(-(dist_mat^2) / (2 * bandwidth^2))
weights
bandwidth <- 100  # meters (your effective buffer size)
weights <- exp(-(dist_mat^2) / (2 * bandwidth^2))
weights
bandwidth <- 1000  # meters (your effective buffer size)
weights <- exp(-(dist_mat^2) / (2 * bandwidth^2))
weights
sensors$pollution_influence <- rowSums(weights)
dim(dist_mat) <- c(nrow(sensors), nrow(polluters))
dim(dist_mat) <- c(nrow(sensors), nrow(polluters))
dim(dist_mat) <- c(nrow(sensors), nrow(polluters))
dim(dist_mat) <- c(nrow(czujniki_sf), nrow(emitory_sf))
bandwidth <- 1000  # meters (your effective buffer size)
weights <- exp(-(dist_mat^2) / (2 * bandwidth^2))
weights
sensors$pollution_influence <- rowSums(weights)
czujniki_sf$pollution_influence <- rowSums(weights)
View(czujniki_sf)
czujniki_sf$emitery <- rowSums(weights)
czujniki_sf$emitory <- rowSums(weights)
library(dplyr)
emitory_sf  <- st_as_sf(emitory_UTM)
czujniki_sf <- st_as_sf(data_in)
dist_mat <- st_distance(czujniki_sf, emitory_sf)
dist_mat <- as.numeric(dist_mat)
dim(dist_mat) <- c(nrow(czujniki_sf), nrow(emitory_sf))
bandwidth <- 1000  # meters (your effective buffer size)
weights <- exp(-(dist_mat^2) / (2 * bandwidth^2))
weights
czujniki_sf$emitory <- rowSums(weights)
corr_df <- data.frame(
matrix(ncol = 4, nrow = 0)  # 3 columns, 0 rows
)
colnames(corr_df) <- c("id","PM10","PM25","emitery")
for (i in 1:64) {
PM10 <- list_inst2[[i]]$current$values$value[list_inst2[[i]]$current$values$name == "PM10"]
PM25 <- list_inst2[[i]]$current$values$value[list_inst2[[i]]$current$values$name == "PM25"]
if (is.null(PM10) || length(PM10) == 0) PM10=-1
if (is.null(PM25) || length(PM25) == 0) PM25=-1
corr_df <- rbind(corr_df, data.frame(id = i, PM10=PM10, PM25=PM25, emitery=czujniki_sf[i]$emitory))
}
czujniki_sf[1]$emitory
czujniki_sf[2]$emitory
czujniki_sf$emitory <- rowSums(weights)
czujniki_sf$emitory
czujniki_sf[0]$emitory
czujniki_sf[1]$emitory
czujniki_sf$emitory
czujniki_sf$emitory[0]
library(dplyr)
emitory_sf  <- st_as_sf(emitory_UTM)
czujniki_sf <- st_as_sf(data_in)
dist_mat <- st_distance(czujniki_sf, emitory_sf)
dist_mat <- as.numeric(dist_mat)
dim(dist_mat) <- c(nrow(czujniki_sf), nrow(emitory_sf))
bandwidth <- 1000  # meters (your effective buffer size)
weights <- exp(-(dist_mat^2) / (2 * bandwidth^2))
weights
czujniki_sf$emitory <- rowSums(weights)
corr_df <- data.frame(
matrix(ncol = 4, nrow = 0)  # 3 columns, 0 rows
)
colnames(corr_df) <- c("id","PM10","PM25","emitery")
czujniki_sf$emitory[1]
for (i in 1:64) {
PM10 <- list_inst2[[i]]$current$values$value[list_inst2[[i]]$current$values$name == "PM10"]
PM25 <- list_inst2[[i]]$current$values$value[list_inst2[[i]]$current$values$name == "PM25"]
if (is.null(PM10) || length(PM10) == 0) PM10=-1
if (is.null(PM25) || length(PM25) == 0) PM25=-1
corr_df <- rbind(corr_df, data.frame(id = i, PM10=PM10, PM25=PM25, emitery=czujniki_sf[i]$emitory))
}
czujniki_sf$emitory[1]
czujniki_sf$emitory[2]
czujniki_sf$emitory[3]
czujniki_sf$emitory[4]
library(dplyr)
emitory_sf  <- st_as_sf(emitory_UTM)
czujniki_sf <- st_as_sf(data_in)
dist_mat <- st_distance(czujniki_sf, emitory_sf)
dist_mat <- as.numeric(dist_mat)
dim(dist_mat) <- c(nrow(czujniki_sf), nrow(emitory_sf))
bandwidth <- 1000  # meters (your effective buffer size)
weights <- exp(-(dist_mat^2) / (2 * bandwidth^2))
weights
czujniki_sf$emitory <- rowSums(weights)
corr_df <- data.frame(
matrix(ncol = 4, nrow = 0)  # 3 columns, 0 rows
)
colnames(corr_df) <- c("id","PM10","PM25","emitery")
for (i in 1:64) {
PM10 <- list_inst2[[i]]$current$values$value[list_inst2[[i]]$current$values$name == "PM10"]
PM25 <- list_inst2[[i]]$current$values$value[list_inst2[[i]]$current$values$name == "PM25"]
if (is.null(PM10) || length(PM10) == 0) PM10=-1
if (is.null(PM25) || length(PM25) == 0) PM25=-1
corr_df <- rbind(corr_df, data.frame(id = i, PM10=PM10, PM25=PM25, emitery=czujniki_sf$emitory[1])
))
library(dplyr)
emitory_sf  <- st_as_sf(emitory_UTM)
czujniki_sf <- st_as_sf(data_in)
dist_mat <- st_distance(czujniki_sf, emitory_sf)
dist_mat <- as.numeric(dist_mat)
dim(dist_mat) <- c(nrow(czujniki_sf), nrow(emitory_sf))
bandwidth <- 1000  # meters (your effective buffer size)
weights <- exp(-(dist_mat^2) / (2 * bandwidth^2))
czujniki_sf$emitory <- rowSums(weights)
corr_df <- data.frame(
matrix(ncol = 4, nrow = 0)  # 3 columns, 0 rows
)
colnames(corr_df) <- c("id","PM10","PM25","emitery")
for (i in 1:64) {
PM10 <- list_inst2[[i]]$current$values$value[list_inst2[[i]]$current$values$name == "PM10"]
PM25 <- list_inst2[[i]]$current$values$value[list_inst2[[i]]$current$values$name == "PM25"]
if (is.null(PM10) || length(PM10) == 0) PM10=-1
if (is.null(PM25) || length(PM25) == 0) PM25=-1
corr_df <- rbind(corr_df, data.frame(id = i, PM10=PM10, PM25=PM25, emitery=czujniki_sf$emitory[i])
))
library(dplyr)
emitory_sf  <- st_as_sf(emitory_UTM)
czujniki_sf <- st_as_sf(data_in)
dist_mat <- st_distance(czujniki_sf, emitory_sf)
dist_mat <- as.numeric(dist_mat)
dim(dist_mat) <- c(nrow(czujniki_sf), nrow(emitory_sf))
bandwidth <- 1000  # meters (your effective buffer size)
weights <- exp(-(dist_mat^2) / (2 * bandwidth^2))
czujniki_sf$emitory <- rowSums(weights)
corr_df <- data.frame(
matrix(ncol = 4, nrow = 0)  # 3 columns, 0 rows
)
colnames(corr_df) <- c("id","PM10","PM25","emitery")
for (i in 1:64) {
PM10 <- list_inst2[[i]]$current$values$value[list_inst2[[i]]$current$values$name == "PM10"]
PM25 <- list_inst2[[i]]$current$values$value[list_inst2[[i]]$current$values$name == "PM25"]
if (is.null(PM10) || length(PM10) == 0) PM10=-1
if (is.null(PM25) || length(PM25) == 0) PM25=-1
corr_df <- rbind(corr_df, data.frame(id = i, PM10=PM10, PM25=PM25, emitery=czujniki_sf$emitory[i]))
))
library(dplyr)
emitory_sf  <- st_as_sf(emitory_UTM)
czujniki_sf <- st_as_sf(data_in)
dist_mat <- st_distance(czujniki_sf, emitory_sf)
dist_mat <- as.numeric(dist_mat)
dim(dist_mat) <- c(nrow(czujniki_sf), nrow(emitory_sf))
bandwidth <- 1000  # meters (your effective buffer size)
weights <- exp(-(dist_mat^2) / (2 * bandwidth^2))
czujniki_sf$emitory <- rowSums(weights)
corr_df <- data.frame(
matrix(ncol = 4, nrow = 0)  # 3 columns, 0 rows
)
colnames(corr_df) <- c("id","PM10","PM25","emitery")
for (i in 1:64) {
PM10 <- list_inst2[[i]]$current$values$value[list_inst2[[i]]$current$values$name == "PM10"]
PM25 <- list_inst2[[i]]$current$values$value[list_inst2[[i]]$current$values$name == "PM25"]
if (is.null(PM10) || length(PM10) == 0) PM10=-1
if (is.null(PM25) || length(PM25) == 0) PM25=-1
corr_df <- rbind(corr_df, data.frame(id = i, PM10=PM10, PM25=PM25, emitery=czujniki_sf$emitory[i]))
}
#ploty do wglądu
# for (id in 1:64){
#   plot(data15_ppp)
#   plot(data15_ppp[id])
#   plot(emitory_by_czujnik[[id]], pch=20,add=TRUE, col='blue')
# }
#jeżeli się nie zaznacza nic na plocie to znaczy że czujnik nie działa
corr_PM10 <- corr_df[,c("id","PM10","emitery")]
filt_PM10 <- subset(corr_PM10, PM10 != -1)
cor(x=filt_PM10$emitery,y=filt_PM10$PM10)
cor.test(filt_PM10$emitery, filt_PM10$PM10, method = "pearson")
plot(x=filt_PM10$emitery,y=filt_PM10$PM10)
corr_PM25 <- corr_df[,c("id","PM25","emitery")]
filt_PM25 <- subset(corr_PM25, PM25 != -1)
cor(x=filt_PM25$emitery,y=filt_PM25$PM25)
cor.test(filt_PM25$emitery, filt_PM25$PM25, method = "pearson")
plot(x=filt_PM25$emitery,y=filt_PM25$PM25)
library(dplyr)
emitory_sf  <- st_as_sf(emitory_UTM)
czujniki_sf <- st_as_sf(data_in)
dist_mat <- st_distance(czujniki_sf, emitory_sf)
dist_mat <- as.numeric(dist_mat)
dim(dist_mat) <- c(nrow(czujniki_sf), nrow(emitory_sf))
bandwidth <- 1000  # meters (your effective buffer size)
weights <- exp(-(dist_mat^2) / (2 * bandwidth^2))
czujniki_sf$emitory <- rowSums(weights)
corr_df <- data.frame(
matrix(ncol = 4, nrow = 0)  # 3 columns, 0 rows
)
colnames(corr_df) <- c("id","PM10","PM25","emitery")
for (i in 1:64) {
PM10 <- list_inst2[[i]]$current$values$value[list_inst2[[i]]$current$values$name == "PM10"]
PM25 <- list_inst2[[i]]$current$values$value[list_inst2[[i]]$current$values$name == "PM25"]
if (is.null(PM10) || length(PM10) == 0) PM10=-1
if (is.null(PM25) || length(PM25) == 0) PM25=-1
corr_df <- rbind(corr_df, data.frame(id = i, PM10=PM10, PM25=PM25, emitery=czujniki_sf$emitory[i]))
}
#ploty do wglądu
# for (id in 1:64){
#   plot(data15_ppp)
#   plot(data15_ppp[id])
#   plot(emitory_by_czujnik[[id]], pch=20,add=TRUE, col='blue')
# }
#jeżeli się nie zaznacza nic na plocie to znaczy że czujnik nie działa
library(dplyr)
emitory_sf  <- st_as_sf(emitory_UTM)
czujniki_sf <- st_as_sf(data_in)
dist_mat <- st_distance(czujniki_sf, emitory_sf)
dist_mat <- as.numeric(dist_mat)
dim(dist_mat) <- c(nrow(czujniki_sf), nrow(emitory_sf))
bandwidth <- 1000  # meters (your effective buffer size)
weights <- exp(-(dist_mat^2) / (2 * bandwidth^2))
czujniki_sf$emitory <- rowSums(weights)
corr_df <- data.frame(
matrix(ncol = 4, nrow = 0)  # 3 columns, 0 rows
)
colnames(corr_df) <- c("id","PM10","PM25","emitery")
for (i in 1:64) {
PM10 <- list_inst2[[i]]$current$values$value[list_inst2[[i]]$current$values$name == "PM10"]
PM25 <- list_inst2[[i]]$current$values$value[list_inst2[[i]]$current$values$name == "PM25"]
if (is.null(PM10) || length(PM10) == 0) PM10=-1
if (is.null(PM25) || length(PM25) == 0) PM25=-1
corr_df <- rbind(corr_df, data.frame(id = i, PM10=PM10, PM25=PM25, emitery=czujniki_sf$emitory[i]))
}
ploty do wglądu
library(dplyr)
emitory_sf  <- st_as_sf(emitory_UTM)
czujniki_sf <- st_as_sf(data_in)
dist_mat <- st_distance(czujniki_sf, emitory_sf)
dist_mat <- as.numeric(dist_mat)
dim(dist_mat) <- c(nrow(czujniki_sf), nrow(emitory_sf))
bandwidth <- 1000  # meters (your effective buffer size)
weights <- exp(-(dist_mat^2) / (2 * bandwidth^2))
czujniki_sf$emitory <- rowSums(weights)
corr_df <- data.frame(
matrix(ncol = 4, nrow = 0)  # 3 columns, 0 rows
)
colnames(corr_df) <- c("id","PM10","PM25","emitery")
for (i in 1:64) {
PM10 <- list_inst2[[i]]$current$values$value[list_inst2[[i]]$current$values$name == "PM10"]
PM25 <- list_inst2[[i]]$current$values$value[list_inst2[[i]]$current$values$name == "PM25"]
if (is.null(PM10) || length(PM10) == 0) PM10=-1
if (is.null(PM25) || length(PM25) == 0) PM25=-1
corr_df <- rbind(corr_df, data.frame(id = i, PM10=PM10, PM25=PM25, emitery=czujniki_sf$emitory[i]))
}
#ploty do wglądu
for (id in 1:64){
plot(data15_ppp)
plot(data15_ppp[id])
plot(emitory_by_czujnik[[id]], pch=20,add=TRUE, col='blue')
}
#jeżeli się nie zaznacza nic na plocie to znaczy że czujnik nie działa
library(dplyr)
emitory_sf  <- st_as_sf(emitory_UTM)
czujniki_sf <- st_as_sf(data_in)
dist_mat <- st_distance(czujniki_sf, emitory_sf)
dist_mat <- as.numeric(dist_mat)
dim(dist_mat) <- c(nrow(czujniki_sf), nrow(emitory_sf))
bandwidth <- 2000  # meters (your effective buffer size)
weights <- exp(-(dist_mat^2) / (2 * bandwidth^2))
czujniki_sf$emitory <- rowSums(weights)
corr_df <- data.frame(
matrix(ncol = 4, nrow = 0)  # 3 columns, 0 rows
)
colnames(corr_df) <- c("id","PM10","PM25","emitery")
for (i in 1:64) {
PM10 <- list_inst2[[i]]$current$values$value[list_inst2[[i]]$current$values$name == "PM10"]
PM25 <- list_inst2[[i]]$current$values$value[list_inst2[[i]]$current$values$name == "PM25"]
if (is.null(PM10) || length(PM10) == 0) PM10=-1
if (is.null(PM25) || length(PM25) == 0) PM25=-1
corr_df <- rbind(corr_df, data.frame(id = i, PM10=PM10, PM25=PM25, emitery=czujniki_sf$emitory[i]))
}
#jeżeli się nie zaznacza nic na plocie to znaczy że czujnik nie działa
corr_PM10 <- corr_df[,c("id","PM10","emitery")]
filt_PM10 <- subset(corr_PM10, PM10 != -1)
cor(x=filt_PM10$emitery,y=filt_PM10$PM10)
cor.test(filt_PM10$emitery, filt_PM10$PM10, method = "pearson")
plot(x=filt_PM10$emitery,y=filt_PM10$PM10)
corr_PM25 <- corr_df[,c("id","PM25","emitery")]
filt_PM25 <- subset(corr_PM25, PM25 != -1)
cor(x=filt_PM25$emitery,y=filt_PM25$PM25)
cor.test(filt_PM25$emitery, filt_PM25$PM25, method = "pearson")
plot(x=filt_PM25$emitery,y=filt_PM25$PM25)
library(dplyr)
emitory_sf  <- st_as_sf(emitory_UTM)
czujniki_sf <- st_as_sf(data_in)
dist_mat <- st_distance(czujniki_sf, emitory_sf)
dist_mat <- as.numeric(dist_mat)
dim(dist_mat) <- c(nrow(czujniki_sf), nrow(emitory_sf))
bandwidth <- 5000  # meters (your effective buffer size)
weights <- exp(-(dist_mat^2) / (2 * bandwidth^2))
czujniki_sf$emitory <- rowSums(weights)
corr_df <- data.frame(
matrix(ncol = 4, nrow = 0)  # 3 columns, 0 rows
)
colnames(corr_df) <- c("id","PM10","PM25","emitery")
for (i in 1:64) {
PM10 <- list_inst2[[i]]$current$values$value[list_inst2[[i]]$current$values$name == "PM10"]
PM25 <- list_inst2[[i]]$current$values$value[list_inst2[[i]]$current$values$name == "PM25"]
if (is.null(PM10) || length(PM10) == 0) PM10=-1
if (is.null(PM25) || length(PM25) == 0) PM25=-1
corr_df <- rbind(corr_df, data.frame(id = i, PM10=PM10, PM25=PM25, emitery=czujniki_sf$emitory[i]))
}
#jeżeli się nie zaznacza nic na plocie to znaczy że czujnik nie działa
corr_PM10 <- corr_df[,c("id","PM10","emitery")]
filt_PM10 <- subset(corr_PM10, PM10 != -1)
cor(x=filt_PM10$emitery,y=filt_PM10$PM10)
cor.test(filt_PM10$emitery, filt_PM10$PM10, method = "pearson")
plot(x=filt_PM10$emitery,y=filt_PM10$PM10)
corr_PM25 <- corr_df[,c("id","PM25","emitery")]
filt_PM25 <- subset(corr_PM25, PM25 != -1)
cor(x=filt_PM25$emitery,y=filt_PM25$PM25)
cor.test(filt_PM25$emitery, filt_PM25$PM25, method = "pearson")
plot(x=filt_PM25$emitery,y=filt_PM25$PM25)
library(dplyr)
emitory_sf  <- st_as_sf(emitory_UTM)
czujniki_sf <- st_as_sf(data_in)
dist_mat <- st_distance(czujniki_sf, emitory_sf)
dist_mat <- as.numeric(dist_mat)
dim(dist_mat) <- c(nrow(czujniki_sf), nrow(emitory_sf))
bandwidth <- 10000  # meters (your effective buffer size)
weights <- exp(-(dist_mat^2) / (2 * bandwidth^2))
czujniki_sf$emitory <- rowSums(weights)
corr_df <- data.frame(
matrix(ncol = 4, nrow = 0)  # 3 columns, 0 rows
)
colnames(corr_df) <- c("id","PM10","PM25","emitery")
for (i in 1:64) {
PM10 <- list_inst2[[i]]$current$values$value[list_inst2[[i]]$current$values$name == "PM10"]
PM25 <- list_inst2[[i]]$current$values$value[list_inst2[[i]]$current$values$name == "PM25"]
if (is.null(PM10) || length(PM10) == 0) PM10=-1
if (is.null(PM25) || length(PM25) == 0) PM25=-1
corr_df <- rbind(corr_df, data.frame(id = i, PM10=PM10, PM25=PM25, emitery=czujniki_sf$emitory[i]))
}
#jeżeli się nie zaznacza nic na plocie to znaczy że czujnik nie działa
corr_PM10 <- corr_df[,c("id","PM10","emitery")]
filt_PM10 <- subset(corr_PM10, PM10 != -1)
cor(x=filt_PM10$emitery,y=filt_PM10$PM10)
cor.test(filt_PM10$emitery, filt_PM10$PM10, method = "pearson")
plot(x=filt_PM10$emitery,y=filt_PM10$PM10)
corr_PM25 <- corr_df[,c("id","PM25","emitery")]
filt_PM25 <- subset(corr_PM25, PM25 != -1)
cor(x=filt_PM25$emitery,y=filt_PM25$PM25)
cor.test(filt_PM25$emitery, filt_PM25$PM25, method = "pearson")
plot(x=filt_PM25$emitery,y=filt_PM25$PM25)
