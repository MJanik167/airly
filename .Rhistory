#print(miss[[colname]][r])
}else{
#miss[[colname]][r] <- FALSE
}
}
}
for (colname in pm25_names){
miss_vec <- miss[[paste0("miss_", colname)]]
m<-sort(czujniki_spdf@data[!miss_vec,colname])[30]
for( r in  seq_len(nrow(czujniki_spdf@data))){
miss[[colname]][r] <- TRUE
if((czujniki_spdf@data[r,colname]<m)| is.na(czujniki_spdf@data[r,colname])){
#print(r)
#print(miss[[colname]][r])
}else{
#miss[[colname]][r] <- FALSE
}
}
}
miss
for (colname in pm25_names){
miss_vec <- miss[[paste0("miss_", colname)]]
m<-sort(czujniki_spdf@data[!miss_vec,colname])[30]
for( r in  seq_len(nrow(czujniki_spdf@data))){
if((czujniki_spdf@data[r,colname]<m)| is.na(czujniki_spdf@data[r,colname])){
miss[[paste0("miss_", colname)]][r] <- TRUE
#print(r)
#print(miss[[colname]][r])
}else{
miss[[paste0("miss_", colname)]][r] <- FALSE
}
}
}
miss
miss <-lapply(pm25_names, function(colname) {
is.na(czujniki_spdf@data[[colname]])
})
for (row in seq_len(nrow(czujniki_spdf@data))){
if(rowSums(as.data.frame(czujniki_spdf@data[row,3:12]))<100 | rowSums(is.na(as.data.frame(czujniki_spdf@data[row,3:12]))) > 0 | row == 2){
for( i in seq(1,length(miss))){
print(row)
miss[[i]][row] = TRUE
}
}
}
names(miss) <- paste0("miss_", pm25_names)
miss
for (colname in pm25_names){
miss_vec <- miss[[paste0("miss_", colname)]]
m<-sort(czujniki_spdf@data[!miss_vec,colname])[10]
for( r in  seq_len(nrow(czujniki_spdf@data))){
if((czujniki_spdf@data[r,colname]<m)| is.na(czujniki_spdf@data[r,colname])){
miss[[paste0("miss_", colname)]][r] <- TRUE
#print(r)
#print(miss[[colname]][r])
}else{
miss[[paste0("miss_", colname)]][r] <- FALSE
}
}
}
miss
m<-sort(czujniki_spdf@data[!miss_vec,colname])[40]
czujniki_spdf@data[5,colname]<m
sum(miss[[colname]])
sum(miss[[colname]])
miss <-lapply(pm25_names, function(colname) {
is.na(czujniki_spdf@data[[colname]])
})
for (row in seq_len(nrow(czujniki_spdf@data))){
if(rowSums(as.data.frame(czujniki_spdf@data[row,3:12]))<100 | rowSums(is.na(as.data.frame(czujniki_spdf@data[row,3:12]))) > 0 | row == 2){
for( i in seq(1,length(miss))){
print(row)
miss[[i]][row] = TRUE
}
}
}
names(miss) <- paste0("miss_", pm25_names)
miss
for (colname in pm25_names){
miss_vec <- miss[[paste0("miss_", colname)]]
m<-sort(czujniki_spdf@data[!miss_vec,colname])[10]
for( r in  seq_len(nrow(czujniki_spdf@data))){
if((czujniki_spdf@data[r,colname]<m)| is.na(czujniki_spdf@data[r,colname])){
miss[[paste0("miss_", colname)]][r] <- TRUE
#print(r)
#print(miss[[colname]][r])
}else{
miss[[paste0("miss_", colname)]][r] <- FALSE
}
}
}
sum(miss[[colname]])
miss <-lapply(pm25_names, function(colname) {
is.na(czujniki_spdf@data[[colname]])
})
for (row in seq_len(nrow(czujniki_spdf@data))){
if(rowSums(as.data.frame(czujniki_spdf@data[row,3:12]))<100 | rowSums(is.na(as.data.frame(czujniki_spdf@data[row,3:12]))) > 0 | row == 2){
for( i in seq(1,length(miss))){
miss[[i]][row] = TRUE
}
}
}
names(miss) <- paste0("miss_", pm25_names)
miss
for (colname in pm25_names){
miss_vec <- miss[[paste0("miss_", colname)]]
m<-sort(czujniki_spdf@data[!miss_vec,colname])[10]
for( r in  seq_len(nrow(czujniki_spdf@data))){
if((czujniki_spdf@data[r,colname]<m)| is.na(czujniki_spdf@data[r,colname])){
miss[[paste0("miss_", colname)]][r] <- TRUE
#print(r)
#print(miss[[colname]][r])
}else{
miss[[paste0("miss_", colname)]][r] <- FALSE
}
}
}
sum(miss[[colname]])
for (colname in pm25_names) {
miss_vec <- miss[[paste0("miss_", colname)]]
print(miss_vec)
PM25_gauss <- autoKrige(as.formula(paste(colname, "~ 1")), input_data = czujniki_spdf[!miss_vec,colname], new_data=spgrid,  model="Sph")
print(nrow(czujniki_spdf[!miss_vec,colname]))
print(plot(PM25_gauss$krige_output[1],main=colname))
print(points(czujniki_ppp_id[!miss_vec,],pch="*",col="White"))
print(plot(PM25_gauss))
}
miss <-lapply(pm25_names, function(colname) {
is.na(czujniki_spdf@data[[colname]])
})
for (row in seq_len(nrow(czujniki_spdf@data))){
if(rowSums(as.data.frame(czujniki_spdf@data[row,3:12]))<100 | rowSums(is.na(as.data.frame(czujniki_spdf@data[row,3:12]))) > 0 | row == 2){
for( i in seq(1,length(miss))){
miss[[i]][row] = TRUE
}
}
}
names(miss) <- paste0("miss_", pm25_names)
miss
for (colname in pm25_names){
miss_vec <- miss[[paste0("miss_", colname)]]
m<-sort(czujniki_spdf@data[!miss_vec,colname])[5]
for( r in  seq_len(nrow(czujniki_spdf@data))){
if((czujniki_spdf@data[r,colname]<m)| is.na(czujniki_spdf@data[r,colname])){
miss[[paste0("miss_", colname)]][r] <- TRUE
#print(r)
#print(miss[[colname]][r])
}else{
miss[[paste0("miss_", colname)]][r] <- FALSE
}
}
}
sum(miss[[colname]])
for (colname in pm25_names) {
miss_vec <- miss[[paste0("miss_", colname)]]
print(miss_vec)
PM25_gauss <- autoKrige(as.formula(paste(colname, "~ 1")), input_data = czujniki_spdf[!miss_vec,colname], new_data=spgrid,  model="Sph")
print(nrow(czujniki_spdf[!miss_vec,colname]))
print(plot(PM25_gauss$krige_output[1],main=colname))
print(points(czujniki_ppp_id[!miss_vec,],pch="*",col="White"))
print(plot(PM25_gauss))
}
miss <-lapply(pm25_names, function(colname) {
is.na(czujniki_spdf@data[[colname]])
})
for (row in seq_len(nrow(czujniki_spdf@data))){
if(rowSums(as.data.frame(czujniki_spdf@data[row,3:12]))<100 | rowSums(is.na(as.data.frame(czujniki_spdf@data[row,3:12]))) > 0 | row == 2){
for( i in seq(1,length(miss))){
miss[[i]][row] = TRUE
}
}
}
names(miss) <- paste0("miss_", pm25_names)
miss
for (colname in pm25_names){
miss_vec <- miss[[paste0("miss_", colname)]]
m<-sort(czujniki_spdf@data[!miss_vec,colname])[10]
for( r in  seq_len(nrow(czujniki_spdf@data))){
if((czujniki_spdf@data[r,colname]<m)| is.na(czujniki_spdf@data[r,colname])){
miss[[paste0("miss_", colname)]][r] <- TRUE
#print(r)
#print(miss[[colname]][r])
}else{
miss[[paste0("miss_", colname)]][r] <- FALSE
}
}
}
sum(miss[[colname]])
for (colname in pm25_names) {
miss_vec <- miss[[paste0("miss_", colname)]]
print(miss_vec)
PM25_gauss <- autoKrige(as.formula(paste(colname, "~ 1")), input_data = czujniki_spdf[!miss_vec,colname], new_data=spgrid,  model="Sph")
print(nrow(czujniki_spdf[!miss_vec,colname]))
print(plot(PM25_gauss$krige_output[1],main=colname))
print(points(czujniki_ppp_id[!miss_vec,],pch="*",col="White"))
print(plot(PM25_gauss))
}
miss <-lapply(pm25_names, function(colname) {
is.na(czujniki_spdf@data[[colname]])
})
for (row in seq_len(nrow(czujniki_spdf@data))){
if(rowSums(as.data.frame(czujniki_spdf@data[row,3:12]))<100 | rowSums(is.na(as.data.frame(czujniki_spdf@data[row,3:12]))) > 0 | row == 2){
for( i in seq(1,length(miss))){
miss[[i]][row] = TRUE
}
}
}
names(miss) <- paste0("miss_", pm25_names)
miss
for (colname in pm25_names){
miss_vec <- miss[[paste0("miss_", colname)]]
m<-sort(czujniki_spdf@data[!miss_vec,colname])[5]
w<-sort(czujniki_spdf@data[!miss_vec,colname],decreasing = TRUE)[5]
for( r in  seq_len(nrow(czujniki_spdf@data))){
if((czujniki_spdf@data[r,colname]<=m)| (czujniki_spdf@data[r,colname]>=m)|is.na(czujniki_spdf@data[r,colname])){
miss[[paste0("miss_", colname)]][r] <- TRUE
#print(r)
#print(miss[[colname]][r])
}else{
miss[[paste0("miss_", colname)]][r] <- FALSE
}
}
}
sum(miss[[colname]])
miss <-lapply(pm25_names, function(colname) {
is.na(czujniki_spdf@data[[colname]])
})
for (row in seq_len(nrow(czujniki_spdf@data))){
if(rowSums(as.data.frame(czujniki_spdf@data[row,3:12]))<100 | rowSums(is.na(as.data.frame(czujniki_spdf@data[row,3:12]))) > 0 | row == 2){
for( i in seq(1,length(miss))){
miss[[i]][row] = TRUE
}
}
}
names(miss) <- paste0("miss_", pm25_names)
miss
for (colname in pm25_names){
miss_vec <- miss[[paste0("miss_", colname)]]
m<-sort(czujniki_spdf@data[!miss_vec,colname])[5]
w<-sort(czujniki_spdf@data[!miss_vec,colname],decreasing = TRUE)[5]
for( r in  seq_len(nrow(czujniki_spdf@data))){
if((czujniki_spdf@data[r,colname]<=m)| (czujniki_spdf@data[r,colname]>=w)|is.na(czujniki_spdf@data[r,colname])){
miss[[paste0("miss_", colname)]][r] <- TRUE
#print(r)
#print(miss[[colname]][r])
}else{
miss[[paste0("miss_", colname)]][r] <- FALSE
}
}
}
sum(miss[[colname]])
for (colname in pm25_names) {
miss_vec <- miss[[paste0("miss_", colname)]]
print(miss_vec)
PM25_gauss <- autoKrige(as.formula(paste(colname, "~ 1")), input_data = czujniki_spdf[!miss_vec,colname], new_data=spgrid,  model="Sph")
print(nrow(czujniki_spdf[!miss_vec,colname]))
print(plot(PM25_gauss$krige_output[1],main=colname))
print(points(czujniki_ppp_id[!miss_vec,],pch="*",col="White"))
print(plot(PM25_gauss))
}
miss <-lapply(pm25_names, function(colname) {
is.na(czujniki_spdf@data[[colname]])
})
for (row in seq_len(nrow(czujniki_spdf@data))){
if(rowSums(as.data.frame(czujniki_spdf@data[row,3:12]))<100 | rowSums(is.na(as.data.frame(czujniki_spdf@data[row,3:12]))) > 0 | row == 2){
for( i in seq(1,length(miss))){
miss[[i]][row] = TRUE
}
}
}
names(miss) <- paste0("miss_", pm25_names)
miss
for (colname in pm25_names){
miss_vec <- miss[[paste0("miss_", colname)]]
m<-sort(czujniki_spdf@data[!miss_vec,colname])[10]
w<-sort(czujniki_spdf@data[!miss_vec,colname],decreasing = TRUE)[10]
for( r in  seq_len(nrow(czujniki_spdf@data))){
if((czujniki_spdf@data[r,colname]<=m)| (czujniki_spdf@data[r,colname]>=w)|is.na(czujniki_spdf@data[r,colname])){
miss[[paste0("miss_", colname)]][r] <- TRUE
#print(r)
#print(miss[[colname]][r])
}else{
miss[[paste0("miss_", colname)]][r] <- FALSE
}
}
}
sum(miss[[colname]])
for (colname in pm25_names) {
miss_vec <- miss[[paste0("miss_", colname)]]
print(miss_vec)
PM25_gauss <- autoKrige(as.formula(paste(colname, "~ 1")), input_data = czujniki_spdf[!miss_vec,colname], new_data=spgrid,  model="Sph")
print(nrow(czujniki_spdf[!miss_vec,colname]))
print(plot(PM25_gauss$krige_output[1],main=colname))
print(points(czujniki_ppp_id[!miss_vec,],pch="*",col="White"))
print(plot(PM25_gauss))
}
miss <-lapply(pm25_names, function(colname) {
is.na(czujniki_spdf@data[[colname]])
})
for (row in seq_len(nrow(czujniki_spdf@data))){
if(rowSums(as.data.frame(czujniki_spdf@data[row,3:12]))<100 | rowSums(is.na(as.data.frame(czujniki_spdf@data[row,3:12]))) > 0 | row == 2){
for( i in seq(1,length(miss))){
miss[[i]][row] = TRUE
}
}
}
names(miss) <- paste0("miss_", pm25_names)
miss
for (colname in pm25_names){
miss_vec <- miss[[paste0("miss_", colname)]]
m<-sort(czujniki_spdf@data[!miss_vec,colname])[10]
w<-sort(czujniki_spdf@data[!miss_vec,colname],decreasing = TRUE)[3]
for( r in  seq_len(nrow(czujniki_spdf@data))){
if((czujniki_spdf@data[r,colname]<=m)| (czujniki_spdf@data[r,colname]>=w)|is.na(czujniki_spdf@data[r,colname])){
miss[[paste0("miss_", colname)]][r] <- TRUE
#print(r)
#print(miss[[colname]][r])
}else{
miss[[paste0("miss_", colname)]][r] <- FALSE
}
}
}
sum(miss[[colname]])
for (colname in pm25_names) {
miss_vec <- miss[[paste0("miss_", colname)]]
print(miss_vec)
PM25_gauss <- autoKrige(as.formula(paste(colname, "~ 1")), input_data = czujniki_spdf[!miss_vec,colname], new_data=spgrid,  model="Sph")
print(nrow(czujniki_spdf[!miss_vec,colname]))
print(plot(PM25_gauss$krige_output[1],main=colname))
print(points(czujniki_ppp_id[!miss_vec,],pch="*",col="White"))
print(plot(PM25_gauss))
}
miss <-lapply(pm25_names, function(colname) {
is.na(czujniki_spdf@data[[colname]])
})
for (row in seq_len(nrow(czujniki_spdf@data))){
if(rowSums(as.data.frame(czujniki_spdf@data[row,3:12]))<100 | rowSums(is.na(as.data.frame(czujniki_spdf@data[row,3:12]))) > 0 | row == 2){
for( i in seq(1,length(miss))){
miss[[i]][row] = TRUE
}
}
}
names(miss) <- paste0("miss_", pm25_names)
miss
for (colname in pm25_names){
miss_vec <- miss[[paste0("miss_", colname)]]
m<-sort(czujniki_spdf@data[!miss_vec,colname])[5]
w<-sort(czujniki_spdf@data[!miss_vec,colname],decreasing = TRUE)[3]
for( r in  seq_len(nrow(czujniki_spdf@data))){
if((czujniki_spdf@data[r,colname]<=m)| (czujniki_spdf@data[r,colname]>=w)|is.na(czujniki_spdf@data[r,colname])){
miss[[paste0("miss_", colname)]][r] <- TRUE
#print(r)
#print(miss[[colname]][r])
}else{
miss[[paste0("miss_", colname)]][r] <- FALSE
}
}
}
sum(miss[[colname]])
for (colname in pm25_names) {
miss_vec <- miss[[paste0("miss_", colname)]]
print(miss_vec)
PM25_gauss <- autoKrige(as.formula(paste(colname, "~ 1")), input_data = czujniki_spdf[!miss_vec,colname], new_data=spgrid,  model="Sph")
print(nrow(czujniki_spdf[!miss_vec,colname]))
print(plot(PM25_gauss$krige_output[1],main=colname))
print(points(czujniki_ppp_id[!miss_vec,],pch="*",col="White"))
print(plot(PM25_gauss))
}
miss <-lapply(pm25_names, function(colname) {
is.na(czujniki_spdf@data[[colname]])
})
for (row in seq_len(nrow(czujniki_spdf@data))){
if(rowSums(as.data.frame(czujniki_spdf@data[row,3:12]))<100 | rowSums(is.na(as.data.frame(czujniki_spdf@data[row,3:12]))) > 0 | row == 2){
for( i in seq(1,length(miss))){
miss[[i]][row] = TRUE
}
}
}
names(miss) <- paste0("miss_", pm25_names)
miss
for (colname in pm25_names){
miss_vec <- miss[[paste0("miss_", colname)]]
m<-sort(czujniki_spdf@data[!miss_vec,colname],decreasing = FALSE)[3]
w<-sort(czujniki_spdf@data[!miss_vec,colname],decreasing = TRUE)[3]
for( r in  seq_len(nrow(czujniki_spdf@data))){
if((czujniki_spdf@data[r,colname]<=m)| (czujniki_spdf@data[r,colname]>=w)|is.na(czujniki_spdf@data[r,colname])){
miss[[paste0("miss_", colname)]][r] <- TRUE
#print(r)
#print(miss[[colname]][r])
}else{
miss[[paste0("miss_", colname)]][r] <- FALSE
}
}
}
sum(miss[[colname]])
for (colname in pm25_names) {
miss_vec <- miss[[paste0("miss_", colname)]]
print(miss_vec)
PM25_gauss <- autoKrige(as.formula(paste(colname, "~ 1")), input_data = czujniki_spdf[!miss_vec,colname], new_data=spgrid,  model="Sph")
print(nrow(czujniki_spdf[!miss_vec,colname]))
print(plot(PM25_gauss$krige_output[1],main=colname))
print(points(czujniki_ppp_id[!miss_vec,],pch="*",col="White"))
print(plot(PM25_gauss))
}
miss <-lapply(pm25_names, function(colname) {
is.na(czujniki_spdf@data[[colname]])
})
for (row in seq_len(nrow(czujniki_spdf@data))){
if(rowSums(as.data.frame(czujniki_spdf@data[row,3:12]))<100 | rowSums(is.na(as.data.frame(czujniki_spdf@data[row,3:12]))) > 0 | row == 2){
for( i in seq(1,length(miss))){
miss[[i]][row] = TRUE
}
}
}
names(miss) <- paste0("miss_", pm25_names)
miss
for (colname in pm25_names){
miss_vec <- miss[[paste0("miss_", colname)]]
m<-sort(czujniki_spdf@data[!miss_vec,colname],decreasing = FALSE)[7]
w<-sort(czujniki_spdf@data[!miss_vec,colname],decreasing = TRUE)[3]
for( r in  seq_len(nrow(czujniki_spdf@data))){
if((czujniki_spdf@data[r,colname]<=m)| (czujniki_spdf@data[r,colname]>=w)|is.na(czujniki_spdf@data[r,colname])){
miss[[paste0("miss_", colname)]][r] <- TRUE
#print(r)
#print(miss[[colname]][r])
}else{
miss[[paste0("miss_", colname)]][r] <- FALSE
}
}
}
sum(miss[[colname]])
for (colname in pm25_names) {
miss_vec <- miss[[paste0("miss_", colname)]]
print(miss_vec)
PM25_gauss <- autoKrige(as.formula(paste(colname, "~ 1")), input_data = czujniki_spdf[!miss_vec,colname], new_data=spgrid,  model="Sph")
print(nrow(czujniki_spdf[!miss_vec,colname]))
print(plot(PM25_gauss$krige_output[1],main=colname))
print(points(czujniki_ppp_id[!miss_vec,],pch="*",col="White"))
print(plot(PM25_gauss))
}
miss <-lapply(pm25_names, function(colname) {
is.na(czujniki_spdf@data[[colname]])
})
for (row in seq_len(nrow(czujniki_spdf@data))){
if(rowSums(as.data.frame(czujniki_spdf@data[row,3:12]))<100 | rowSums(is.na(as.data.frame(czujniki_spdf@data[row,3:12]))) > 0 | row == 2){
for( i in seq(1,length(miss))){
miss[[i]][row] = TRUE
}
}
}
names(miss) <- paste0("miss_", pm25_names)
miss
for (colname in pm25_names){
miss_vec <- miss[[paste0("miss_", colname)]]
m<-sort(czujniki_spdf@data[!miss_vec,colname],decreasing = FALSE)[8]
w<-sort(czujniki_spdf@data[!miss_vec,colname],decreasing = TRUE)[5]
for( r in  seq_len(nrow(czujniki_spdf@data))){
if((czujniki_spdf@data[r,colname]<=m)| (czujniki_spdf@data[r,colname]>=w)|is.na(czujniki_spdf@data[r,colname])){
miss[[paste0("miss_", colname)]][r] <- TRUE
#print(r)
#print(miss[[colname]][r])
}else{
miss[[paste0("miss_", colname)]][r] <- FALSE
}
}
}
sum(miss[[colname]])
for (colname in pm25_names) {
miss_vec <- miss[[paste0("miss_", colname)]]
print(miss_vec)
PM25_gauss <- autoKrige(as.formula(paste(colname, "~ 1")), input_data = czujniki_spdf[!miss_vec,colname], new_data=spgrid,  model="Sph")
print(nrow(czujniki_spdf[!miss_vec,colname]))
print(plot(PM25_gauss$krige_output[1],main=colname))
print(points(czujniki_ppp_id[!miss_vec,],pch="*",col="White"))
print(plot(PM25_gauss))
}
miss <-lapply(pm25_names, function(colname) {
is.na(czujniki_spdf@data[[colname]])
})
for (row in seq_len(nrow(czujniki_spdf@data))){
if(rowSums(as.data.frame(czujniki_spdf@data[row,3:12]))<100 | rowSums(is.na(as.data.frame(czujniki_spdf@data[row,3:12]))) > 0 | row == 2){
for( i in seq(1,length(miss))){
miss[[i]][row] = TRUE
}
}
}
names(miss) <- paste0("miss_", pm25_names)
miss
for (colname in pm25_names){
miss_vec <- miss[[paste0("miss_", colname)]]
m<-sort(czujniki_spdf@data[!miss_vec,colname],decreasing = FALSE)[10]
w<-sort(czujniki_spdf@data[!miss_vec,colname],decreasing = TRUE)[3]
for( r in  seq_len(nrow(czujniki_spdf@data))){
if((czujniki_spdf@data[r,colname]<=m)| (czujniki_spdf@data[r,colname]>=w)|is.na(czujniki_spdf@data[r,colname])){
miss[[paste0("miss_", colname)]][r] <- TRUE
#print(r)
#print(miss[[colname]][r])
}else{
miss[[paste0("miss_", colname)]][r] <- FALSE
}
}
}
sum(miss[[colname]])
for (colname in pm25_names) {
miss_vec <- miss[[paste0("miss_", colname)]]
print(miss_vec)
PM25_gauss <- autoKrige(as.formula(paste(colname, "~ 1")), input_data = czujniki_spdf[!miss_vec,colname], new_data=spgrid,  model="Sph")
print(nrow(czujniki_spdf[!miss_vec,colname]))
print(plot(PM25_gauss$krige_output[1],main=colname))
print(points(czujniki_ppp_id[!miss_vec,],pch="*",col="White"))
print(plot(PM25_gauss))
}
